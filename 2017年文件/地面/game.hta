 <html> 
<head>
<title>游戏 </title>
<HTA:Application 
       border="thick"
         caption="yes"
         maximizebutton="yes"
         minimizebutton="yes"
         sysmenu="yes"
         windowstate="normal"
    >
</head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<body scroll=no>
<style> 
	body {
	 background-color: #3a6ead;
	}
	#GAME embed{
		width:100%;
		height:100%;
		padding:0; 
		margin:0;
	}
	#list_group li{
		 list-style-type :none;
		 margin-top:10px;
		 display:block;
		 width:100%;
		 float:left;
	}
	#list_group li button{ 
		 width:100%;
		margin-left:10px;
	}
	.btn{ 
		background: #ccc;
		border:#e0e0e0 solid 1px;
		font-size:20px;
		 width:100%;
	} 
</style>
 
<script language="VBScript"> 
Sub RunPosture 
Set objShell = CreateObject("Wscript.Shell")  
objShell.Run "bin\\posture.exe" 
End Sub 
 
 
 
Sub RunConfig
Set objShell = CreateObject("Wscript.Shell") 
objShell.Run "bin\\config.exe" 
End Sub 
 
Sub ExitProgram 
	Set objShell = CreateObject("Shell.Application")  
	objShell.ShellExecute "bin\\exit.bat" 
	window.close() 
End Sub 
 
Sub startProgram(argument1)  
Set objShell = CreateObject("Shell.Application")  
objShell.ShellExecute "game\\run.bat" , argument1 
End Sub
 

</script> 

<div id="SET" >

	<div id="list_group" style="width:50%; padding:10px 20px ; margin:10px 20px;background:#ccc;height:500px;overflow:scroll;float:left;"> 
		<!--
		<li><button  onclick=demo("bin\\config.exe")  >1.小游戏 </button></li>  
		-->      
	</div>
	<div style="text-align:center;width:30%; font-size:15px;height:50px;color:#EEE; padding:10px 20px ; margin:10px 50px;float:left;">
	 
	 <p><button class="btn"  style="display:inline-block;" onclick="vbs:RunConfig()">配置游戏</button></p> 
	 <p> <button class="btn" style="display:inline-block;" onclick="vbs:RunPosture()">开启交互</button>  </p>
	 <hr/>
	 <p> 输入游戏(以,分割） <input type="text" id="lunbo_array" placeholder="">  </p>
	 <p> 输入更换时间(分钟) <input type="text" id="lunbo_time" placeholder="">   </p>
	 <p>   </p>
	 <p><button class="btn"  style="display:inline-block;" onclick="show_lunbo()">保存并开启定时更换</button></p>
	 <p><button class="btn"  style="display:inline-block;" onclick="vbs:ExitProgram()">关闭程序</button>  </p>
 
	   
	</div>
</div>

<div id="GAME" style="display:none;padding:0; margin:0;">
	 
</div>


<script language="javascript" src="game/app.js"></script>
<script language="javascript"  >

TIME_IS_RUN = false;
function show_lunbo(){ 
		var str=lunbo_array.value;
		var time=lunbo_time.value; 
		save_data(str,time);
		if(time<1){
			return false;
		}
		time = time*1000*60; 
		if(str){

			lunbo_array_value = str.split(",");
			lunbo_index =1;    
			callback_show= function(){ 
				if(lunbo_index >= lunbo_array_value.length){
					lunbo_index = 0;
				}
				var key = lunbo_array_value[lunbo_index++];
				 for(var i=0;i<list_group.childNodes.length;i++){
					var child = list_group.childNodes[i];  
					if(child.data_key == key){
						exec_item = child.data_exec;
						startProgram(exec_item);
						break;
					}
				 } 
			}
			callback_show(); 
			 
			if(TIME_IS_RUN==false){ 
				window.setInterval(callback_show,time);
				TIME_IS_RUN = true;
			}
		} 
		
	}
function load_data(){ 
    fso = new ActiveXObject("Scripting.FileSystemObject");
	var f = fso.OpenTextFile("bin/conf.txt",1);   
	data = f.ReadLine();
	conf = data.split(";");
	lunbo_array.value = conf[0];
	lunbo_time.value = conf[1]; 
	show_lunbo();//开启定时更换游戏
	RunPosture();//开启交互
}
function save_data(a1,a2){
   data = a1+";"+a2;
   var fso, tf;
   fso = new ActiveXObject("Scripting.FileSystemObject");
   tf = fso.CreateTextFile("bin/conf.txt", true);  
   tf.Write (data);
   tf.Close();  
}
load_data()
</script>
 

</body>
</html>